<style>
.sameLine {display: inline-block;}
button {margin-left: 10px;
        outline: none;
        border: none;
        background: none;}
.categoryUL {display: none;}
.inlineB {display: inline-block;
          vertical-align: top;
          width: 300px;}
</style>


{{! ************* MAIN HEADING}}
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="block">
          <h1 class="heading"><span> UPDATE YOUR PANTRY </span></h1>


{{! ************* DIVISION FOR INGREDIENTS IN PANTRY}}
          <div class="container inlineB inPantry">
            <div class="containerTitle">
              <h2>Ingredients that you have</h2>
            </div>
            <div class="ingredientContainer" id="inPantryList">

            </div>
          </div>

{{! ************* DIVISION FOR FORM TO ADD INGREDIENT}}
          <div class="container inlineB addIngredient">
            <div class="containerTitle">
              <h2>Add an Ingredient</h2>
            </div>
          </div>

{{! ************* DIVISION FOR INGREDIENTS NOT IN PANTRY}}

          <div class="container inlineB notInPantry">
            <div class="containerTitle">
              <h2>Ingredients you do not have</h2>
            </div>
            <div class="ingredientContainer" id="notInPantryList">

            </div>
          </div>





        </div>
      </div>
    </div>
  </div>


{{!  ******************SCRIPT FILE HERE *****************}}
<script>
  var ingredientsHave = [];
  var ingredientsNotHave = [];
  var categories = [];

{{! ******** FOR EACH INGREDIENT *************** }}
  {{#each ingredient}}

    {{! ******** remove spaces and special characters from category ***}}
    {{! ****  because this term is used as a class name ***************}}

    var cleanCat = "{{this.category}}";
    cleanCat = cleanCat.replace(/[^A-Z0-9]/ig, "_");

    if (categories.indexOf(cleanCat) == -1) {
      categories.push(cleanCat);
    }

    {{! ******** create an object for each ingredient **************}}
    var ing = {name: "{{this.name}}", 
              category: "{{this.category}}",
              id: "{{this.id}}",
              cleanCat: cleanCat};

    {{! ************ IF NOT IN THE PANTRY *********}}
    {{#unless this.inPantry}}

      {{! ***** push that object into an array of all ingredients }}
      ingredientsNotHave.push(ing);

    {{/unless}}

    {{! ************ IF IN THE PANTRY *********}}
    {{#if this.inPantry}}

      {{! ***** push that object into an array of all ingredients }}
      ingredientsHave.push(ing);

    {{/if}}

  {{/each}}
  

  {{! ********* NOW, WE CREATE A SEPERATE DIVISION FOR EACH CATEGORY ****}}

  for (var i=0; i<categories.length; i++) {
    var catDiv = $('<div>');
    catDiv.append('<h4 class="categorySection">' + categories[i] + '</h4>');
    catDiv.append('<ul class = "categoryUL + ' + categories[i] + '"></ul>');
    $('#inPantryList').append(catDiv);
  }
  
  for (var i=0; i<categories.length; i++) {
    var catDiv = $('<div>');
    catDiv.append('<h4 class="categorySection">' + categories[i] + '</h4>');
    catDiv.append('<ul class = "categoryUL ' + categories[i] + '"></ul>');
    $('#notInPantryList').append(catDiv);
  }


   {{! *** THEN, WE CREATE THE HTML FOR EACH INPANTRY INGREDIENT ****}}
   {{! ********* AND APPEND IT TO THE INPANTRY DIVISION *******}}

  for (var i=0; i<ingredientsHave.length; i++) {


    var ingredientLI = $('<li>');
    
    ingredientLI.append('<span class="ingredientName sameLine">' + ingredientsHave[i].name + '</span>');

    ingredientLI.append('<form class="sameLine" action="ingredient/update/' + ingredientsHave[i].id + '?_method=PUT" method="POST"><input type="hidden" name="added" value="true"><button type="submit">x</button></form>')
    console.log(ingredientLI);

    $('#inPantryList').find('.' + ingredientsHave[i].cleanCat).append(ingredientLI);

  }

{{! ****** THEN, WE CREATE THE HTML FOR EACH NOTINPANTRY INGREDIENT ****}}
   {{! ******* AND APPEND IT TO THE NOTINPANTRY CATEGORY DIVISION *******}}


  for (var i=0; i<ingredientsNotHave.length; i++) {
    var ingredientLI = $('<li>');
    
    ingredientLI.append('<span class="ingredientName sameLine">' + ingredientsNotHave[i].name + '</span>');

    ingredientLI.append('<form class="sameLine" action="ingredient/update/' + ingredientsNotHave[i].id + '?_method=PUT" method="POST"><input type="hidden" name="added" value="true"><button type="submit">x</button></form>')

    $('#notInPantryList').find('.' + ingredientsNotHave[i].cleanCat).append(ingredientLI);

  }




$(document).ready(function() {
  $('.categorySection').on('click', function(event){
    console.log("this was clicked");
    event.stopPropagation();
    $(this).closest('div').find('.categoryUL').slideToggle();
    })
});



</script>

